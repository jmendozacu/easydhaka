var mst=jQuery.noConflict();mst(document).ready(function(e){function a(){e("#upload_custom_image");n(0);var a=new FormData;for(e.each(c,function(e,t){t.upload&&a.append(t.name,t.file)});c.length>0;)c.pop();var t=e("#upload_images_form").attr("action");e.ajax({url:t,data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e){try{var a=JSON.parse(e);if("error"==a.status)return alert(a.message),document.getElementById("upload_images_form").reset(),!1;n(100),""!=e&&o(e)}catch(t){console.log(t)}},xhr:function(){return xhr=e.ajaxSettings.xhr(),xhr.upload.onprogress=n,xhr.upload.onloadend=n,xhr}})}function t(a){var t=a.target.files,i=a.target.name;e.each(t,function(e,a){a.type.match("image/")?c.push({name:i,file:a,upload:!0}):(alert("Please upload a file in one of the following formats: .svg, .jpg, .png, .jpeg, .bmp, .gif"),document.getElementById("upload_images_form").reset())})}function i(e,a){return Math.round(a?100*e/a:100).toString()+"%"}function n(a){var t=e.type(a),n="object"==t&&a.lengthComputable?i(a.loaded,a.total):"number"==t?a+"%":"string"==t?a:"0%";e("#response").html(n),"100%"==n?e("#response").hide():e("#response").show()}function o(a){var t=e.parseJSON(a);t.length&&e.each(t,function(a,t){e("#lists_img_upload").append("<span><img color='' src='"+t+"' alt='Custom Upload Image'/></span>")}),document.getElementById("upload_images_form").reset()}var s=e("#url_site").val().replace("index.php/","");PDPsetting.add_html(),PDPsetting.init(),""!=e("#fb_get_id").val()&&(e(".add_artwork_tab").click(),e(".tab_design_image .facebook_api").click()),e("#facebook_album").change(function(){var a=e(this).val();e("#fb_image_list li:not(."+a+")").hide(),e("#fb_image_list li.fb_album_"+a).show()});var r=s,l=r+"media/pdp/images/artworks/";e(".content_designs").append('<span class="loading-img nodisplay">&nbsp;</span>'),Paging={init:function(){this.loadMoreImage(),this.filterByCategory()},loadMoreImage:function(){e("#load_more_image").click(function(){var a=e("#image_category_list li.active").attr("cr_act"),t=e("#image_category_list li.active span").attr("id"),i=e("#default_page_size").val();e.ajax({type:"POST",url:r+"index.php/pdp/index/loadMoreImage",data:{current_page:a,category:t,page_size:i},beforeSend:function(){e(".content_designs .loading-img").show()},error:function(){},success:function(t){if("nomore"!=t){e("#image_category_list li.active").attr("cr_act",parseInt(a)+1);for(var i,n=e.parseJSON(t),o="",s=0;s<n.length;s++)i=n[s].color_img,""!=i&&(i="fff__"+n[s].filename+","+n[s].color_img),o+="<li cat='"+n[s].category+"'> <a class='selection_img' rel='clover'><img color='"+i+"' src='"+l+n[s].filename+"' id='img"+n[s].image_id+"' price='"+n[s].price+"' image_name='"+n[s].image_name+"' color_type='"+n[s].color_type+"'/></a> </li>";e("#icon_list").append(o)}else alert("No more items to load!");e(".content_designs .loading-img").hide()}})})},filterByCategory:function(){e("#image_category_list li").click(function(){if(e("#image_category_list").slideToggle(0),!e(this).hasClass("active")){var a=e(this).find("span").html();if(e("label.design_label .pdp_selected_category").html(a),e("#image_category_list li.active").removeClass("active"),e(this).addClass("active"),e("#icon_list li[cat!="+e(this).children("span").attr("id")+"]").hide(),e("#icon_list li[cat="+e(this).children("span").attr("id")+"]").show(),!e(this).hasClass("cat_loaded")){e(this).addClass("cat_loaded");var t=2,i=e("#image_category_list li.active span").attr("id"),n=e("#default_page_size").val(),o=parseInt(t-1)*parseInt(n);e.ajax({type:"POST",url:r+"index.php/pdp/index/loadMoreImage",data:{current_page:1,category:i,page_size:o},beforeSend:function(){e(".content_designs .loading-img").show()},error:function(){},success:function(a){if("nomore"!=a){for(var t,i=e.parseJSON(a),n="",o=0;o<i.length;o++)t=i[o].color_img,""!=t&&(t="fff__"+i[o].filename+","+i[o].color_img),n+="<li cat='"+i[o].category+"'> <a class='selection_img' rel='clover'><img color='"+t+"' src='"+l+i[o].filename+"' id='img"+i[o].image_id+"' price='"+i[o].price+"' image_name='"+i[o].image_name+"' color_type='"+i[o].color_type+"'/></a> </li>";e("#icon_list").append(n),e("#image_category_list li.active").attr("cr_act",2)}else alert("No more items to load!");e(".content_designs .loading-img").hide()}})}}})}},Paging.init(),e("#fileToUpload").hover(function(){e(this).hasClass("active")||(document.getElementById("fileToUpload").addEventListener("change",t,!1),e(this).addClass("active"))}),e("#upload_custom_img_btn").click(function(){return c.length?e("#agreement").is(":checked")?void a():(alert(e("#agreement_warming").val()),!1):!1});var c=[];PDPAction={doRequest:function(a,t,i){e.ajax({type:"POST",url:a,data:t,beforeSend:function(){e(".pdploading").show()},error:function(){console.log("Something went wrong...")},success:function(a){i(a),e(".pdploading").hide()}})},deferredRequest:function(a,t,i){var n=e.Deferred();return e.ajax({type:"POST",url:a,data:t,beforeSend:function(){e(".pdploading").show()},error:function(){console.log("Something went wrong...")},success:function(e){i(e),n.resolve()}})},save_json_file:function(){},save_cr_design:function(){{var a={inlay:e("#pdp_side_items li.active").attr("inlay"),side:e("#pdp_side_items li.active").attr("tab"),img:e("#pdp_side_items li.active").attr("side_img"),items:[]};e("#skin_url").val(),e("#base_dir").val(),e("#media_url").val(),e("#pdp_side_items li.active").attr("tab"),e("#product_id").val()}resetTextForm();e("#edit_id").val();return e(".product-image .active").removeClass("active"),a},pdp_add_to:function(){var a=[];e(".pdp_info_save").each(function(){var t=e(this).attr("alt"),i=e("#pdp_side_items li[tab="+t+"]").attr("side_img");json_obj={name:t,img:i,json:e(this).val()},e(".design-color-image li.active").length>0&&(json_obj.color=e(".design-color-image li.active").attr("id")),a.push(json_obj)});var t=JSON.stringify(a),i=e("#pdp_btn_action").val();switch(i){case"pdp_add_to_cart":LoadDesign.updatePDPCustomOption(t),e("#pdp_design_popup").hide(),e(".add-to-cart .btn-cart").click();break;case"pdp_add_to_wishlist":LoadDesign.updatePDPCustomOption(t),e("#pdp_design_popup").hide(),""!=e("#wishlist_item_id").val()?e(".add-to-links .link-compare").each(function(){return""!=e(this).attr("onclick")?void e(this).click():void 0}):e(".add-to-links .link-wishlist").click();break;case"pdp_save_admin_sample":var n=e("#url_site").val()+"pdp/index/saveAdminTemplate";currentProductId=e("#current_product_id").val(),data={product_id:currentProductId,pdp_design:t},this.doRequest(n,data,function(){});break;case"save_before_share":this.saveBeforeShare(t);break;case"save_design_btn":LoadDesign.updatePDPCustomOption(t),e("#pdp_design_popup .overlay").click()}},saveBeforeShare:function(a){var t=e("#save_design_url").val(),i=e("#product_url").val(),n={pdpdesign:a,url:i};this.doRequest(t,n,this.activeAddThis)},activeAddThis:function(a){for(var t=e.parseJSON(a),i=0;i<addthis.links.length;i++)addthis.links[i].share.url=t.url;e(".social-bottom .overlay-btn").addClass("send-back")},pdpBtnClick:function(){e(".pdp-btn").on("click",function(){e("#pdp_btn_action").val(e(this).attr("id")),PDPAction.save_cr_design("done")})},loadFonts:function(){var a=r+"index.php/pdp/index/loadFonts";e.ajax({type:"GET",url:a,beforeSend:function(){console.log("Load Font")},error:function(){console.log("Something went wrong...")},success:function(a){e(".fonts-container").html(a)}})}},PDPAction.pdpBtnClick()});